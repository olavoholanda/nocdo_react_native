{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"isAsync":false}},{"name":"../base","data":{"isAsync":false}},{"name":"../derived","data":{"isAsync":false}},{"name":"../core/AnimatedValue","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = spring;\n\n  var _base = _$$_REQUIRE(_dependencyMap[1], \"../base\");\n\n  var _derived = _$$_REQUIRE(_dependencyMap[2], \"../derived\");\n\n  var _AnimatedValue = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[3], \"../core/AnimatedValue\"));\n\n  var MAX_STEPS_MS = 64;\n\n  function spring(clock, state, config) {\n    var lastTime = (0, _base.cond)(state.time, state.time, clock);\n    var deltaTime = (0, _derived.min)((0, _base.sub)(clock, lastTime), MAX_STEPS_MS);\n    var c = config.damping;\n    var m = config.mass;\n    var k = config.stiffness;\n    var v0 = (0, _base.multiply)(-1, state.velocity);\n    var x0 = (0, _base.sub)(config.toValue, state.position);\n    var zeta = (0, _base.divide)(c, (0, _base.multiply)(2, (0, _base.sqrt)((0, _base.multiply)(k, m))));\n    var omega0 = (0, _base.sqrt)((0, _base.divide)(k, m));\n    var omega1 = (0, _base.multiply)(omega0, (0, _base.sqrt)((0, _base.sub)(1, (0, _base.multiply)(zeta, zeta))));\n    var t = (0, _base.divide)(deltaTime, 1000);\n    var sin1 = (0, _base.sin)((0, _base.multiply)(omega1, t));\n    var cos1 = (0, _base.cos)((0, _base.multiply)(omega1, t));\n    var underDampedEnvelope = (0, _base.exp)((0, _base.multiply)(-1, zeta, omega0, t));\n    var underDampedFrag1 = (0, _base.multiply)(underDampedEnvelope, (0, _base.add)((0, _base.multiply)(sin1, (0, _base.divide)((0, _base.add)(v0, (0, _base.multiply)(zeta, omega0, x0)), omega1)), (0, _base.multiply)(x0, cos1)));\n    var underDampedPosition = (0, _base.sub)(config.toValue, underDampedFrag1);\n    var underDampedVelocity = (0, _base.sub)((0, _base.multiply)(zeta, omega0, underDampedFrag1), (0, _base.multiply)(underDampedEnvelope, (0, _base.sub)((0, _base.multiply)(cos1, (0, _base.add)(v0, (0, _base.multiply)(zeta, omega0, x0))), (0, _base.multiply)(omega1, x0, sin1))));\n    var criticallyDampedEnvelope = (0, _base.exp)((0, _base.multiply)(-1, omega0, t));\n    var criticallyDampedPosition = (0, _base.sub)(config.toValue, (0, _base.multiply)(criticallyDampedEnvelope, (0, _base.add)(x0, (0, _base.multiply)((0, _base.add)(v0, (0, _base.multiply)(omega0, x0)), t))));\n    var criticallyDampedVelocity = (0, _base.multiply)(criticallyDampedEnvelope, (0, _base.add)((0, _base.multiply)(v0, (0, _base.sub)((0, _base.multiply)(t, omega0), 1)), (0, _base.multiply)(t, x0, omega0, omega0)));\n    var prevPosition = new _AnimatedValue.default(0);\n    var isOvershooting = (0, _base.cond)((0, _base.and)(config.overshootClamping, (0, _base.neq)(config.stiffness, 0)), (0, _base.cond)((0, _base.lessThan)(prevPosition, config.toValue), (0, _base.greaterThan)(state.position, config.toValue), (0, _base.lessThan)(state.position, config.toValue)));\n    var isVelocity = (0, _base.lessThan)((0, _derived.abs)(state.velocity), config.restSpeedThreshold);\n    var isDisplacement = (0, _base.or)((0, _base.eq)(config.stiffness, 0), (0, _base.lessThan)((0, _derived.abs)((0, _base.sub)(config.toValue, state.position)), config.restDisplacementThreshold));\n    return (0, _base.block)([(0, _base.set)(prevPosition, state.position), (0, _base.cond)((0, _base.lessThan)(zeta, 1), [(0, _base.set)(state.position, underDampedPosition), (0, _base.set)(state.velocity, underDampedVelocity)], [(0, _base.set)(state.position, criticallyDampedPosition), (0, _base.set)(state.velocity, criticallyDampedVelocity)]), (0, _base.set)(state.time, clock), (0, _base.cond)((0, _base.or)(isOvershooting, (0, _base.and)(isVelocity, isDisplacement)), [(0, _base.cond)((0, _base.neq)(config.stiffness, 0), [(0, _base.set)(state.velocity, 0), (0, _base.set)(state.position, config.toValue)]), (0, _base.set)(state.finished, 1)])]);\n  }\n});","map":[[9,0,1,0],[11,0,20,0],[13,0,21,0],[15,0,23,0],[15,6,23,6,"MAX_STEPS_MS"],[15,18,23,18],[15,21,23,21],[15,23,23,0],[17,0,25,15],[17,11,25,24,"spring"],[17,17,25,15],[17,18,25,31,"clock"],[17,23,25,15],[17,25,25,38,"state"],[17,30,25,15],[17,32,25,45,"config"],[17,38,25,15],[17,40,25,53],[18,0,26,2],[18,8,26,8,"lastTime"],[18,16,26,16],[18,19,26,19],[18,35,26,24,"state"],[18,40,26,29],[18,41,26,30,"time"],[18,45,26,19],[18,47,26,36,"state"],[18,52,26,41],[18,53,26,42,"time"],[18,57,26,19],[18,59,26,48,"clock"],[18,64,26,19],[18,65,26,2],[19,0,28,2],[19,8,28,8,"deltaTime"],[19,17,28,17],[19,20,28,20],[19,38,28,24],[19,53,28,28,"clock"],[19,58,28,24],[19,60,28,35,"lastTime"],[19,68,28,24],[19,69,28,20],[19,71,28,46,"MAX_STEPS_MS"],[19,83,28,20],[19,84,28,2],[20,0,30,2],[20,8,30,8,"c"],[20,9,30,9],[20,12,30,12,"config"],[20,18,30,18],[20,19,30,19,"damping"],[20,26,30,2],[21,0,31,2],[21,8,31,8,"m"],[21,9,31,9],[21,12,31,12,"config"],[21,18,31,18],[21,19,31,19,"mass"],[21,23,31,2],[22,0,32,2],[22,8,32,8,"k"],[22,9,32,9],[22,12,32,12,"config"],[22,18,32,18],[22,19,32,19,"stiffness"],[22,28,32,2],[23,0,34,2],[23,8,34,8,"v0"],[23,10,34,10],[23,13,34,13],[23,33,34,22],[23,34,34,23],[23,35,34,13],[23,37,34,26,"state"],[23,42,34,31],[23,43,34,32,"velocity"],[23,51,34,13],[23,52,34,2],[24,0,35,2],[24,8,35,8,"x0"],[24,10,35,10],[24,13,35,13],[24,28,35,17,"config"],[24,34,35,23],[24,35,35,24,"toValue"],[24,42,35,13],[24,44,35,33,"state"],[24,49,35,38],[24,50,35,39,"position"],[24,58,35,13],[24,59,35,2],[25,0,37,2],[25,8,37,8,"zeta"],[25,12,37,12],[25,15,37,15],[25,33,37,22,"c"],[25,34,37,15],[25,36,37,25],[25,56,37,34],[25,57,37,25],[25,59,37,37],[25,75,37,42],[25,95,37,51,"k"],[25,96,37,42],[25,98,37,54,"m"],[25,99,37,42],[25,100,37,37],[25,101,37,25],[25,102,37,15],[25,103,37,2],[26,0,38,2],[26,8,38,8,"omega0"],[26,14,38,14],[26,17,38,17],[26,33,38,22],[26,51,38,29,"k"],[26,52,38,22],[26,54,38,32,"m"],[26,55,38,22],[26,56,38,17],[26,57,38,2],[27,0,39,2],[27,8,39,8,"omega1"],[27,14,39,14],[27,17,39,17],[27,37,39,26,"omega0"],[27,43,39,17],[27,45,39,34],[27,61,39,39],[27,76,39,43],[27,77,39,39],[27,79,39,46],[27,99,39,55,"zeta"],[27,103,39,46],[27,105,39,61,"zeta"],[27,109,39,46],[27,110,39,39],[27,111,39,34],[27,112,39,17],[27,113,39,2],[28,0,41,2],[28,8,41,8,"t"],[28,9,41,9],[28,12,41,12],[28,30,41,19,"deltaTime"],[28,39,41,12],[28,41,41,30],[28,45,41,12],[28,46,41,2],[29,0,43,2],[29,8,43,8,"sin1"],[29,12,43,12],[29,15,43,15],[29,30,43,19],[29,50,43,28,"omega1"],[29,56,43,19],[29,58,43,36,"t"],[29,59,43,19],[29,60,43,15],[29,61,43,2],[30,0,44,2],[30,8,44,8,"cos1"],[30,12,44,12],[30,15,44,15],[30,30,44,19],[30,50,44,28,"omega1"],[30,56,44,19],[30,58,44,36,"t"],[30,59,44,19],[30,60,44,15],[30,61,44,2],[31,0,47,2],[31,8,47,8,"underDampedEnvelope"],[31,27,47,27],[31,30,47,30],[31,45,47,34],[31,65,47,43],[31,66,47,44],[31,67,47,34],[31,69,47,47,"zeta"],[31,73,47,34],[31,75,47,53,"omega0"],[31,81,47,34],[31,83,47,61,"t"],[31,84,47,34],[31,85,47,30],[31,86,47,2],[32,0,48,2],[32,8,48,8,"underDampedFrag1"],[32,24,48,24],[32,27,48,27],[32,47,49,4,"underDampedEnvelope"],[32,66,48,27],[32,68,50,4],[32,83,51,6],[32,103,51,15,"sin1"],[32,107,51,6],[32,109,51,21],[32,127,51,28],[32,142,51,32,"v0"],[32,144,51,28],[32,146,51,36],[32,166,51,45,"zeta"],[32,170,51,36],[32,172,51,51,"omega0"],[32,178,51,36],[32,180,51,59,"x0"],[32,182,51,36],[32,183,51,28],[32,184,51,21],[32,186,51,65,"omega1"],[32,192,51,21],[32,193,51,6],[32,194,50,4],[32,196,52,6],[32,216,52,15,"x0"],[32,218,52,6],[32,220,52,19,"cos1"],[32,224,52,6],[32,225,50,4],[32,226,48,27],[32,227,48,2],[33,0,55,2],[33,8,55,8,"underDampedPosition"],[33,27,55,27],[33,30,55,30],[33,45,55,34,"config"],[33,51,55,40],[33,52,55,41,"toValue"],[33,59,55,30],[33,61,55,50,"underDampedFrag1"],[33,77,55,30],[33,78,55,2],[34,0,57,2],[34,8,57,8,"underDampedVelocity"],[34,27,57,27],[34,30,57,30],[34,45,58,4],[34,65,58,13,"zeta"],[34,69,58,4],[34,71,58,19,"omega0"],[34,77,58,4],[34,79,58,27,"underDampedFrag1"],[34,95,58,4],[34,96,57,30],[34,98,59,4],[34,118,60,6,"underDampedEnvelope"],[34,137,59,4],[34,139,61,6],[34,154,62,8],[34,174,62,17,"cos1"],[34,178,62,8],[34,180,62,23],[34,195,62,27,"v0"],[34,197,62,23],[34,199,62,31],[34,219,62,40,"zeta"],[34,223,62,31],[34,225,62,46,"omega0"],[34,231,62,31],[34,233,62,54,"x0"],[34,235,62,31],[34,236,62,23],[34,237,62,8],[34,238,61,6],[34,240,63,8],[34,260,63,17,"omega1"],[34,266,63,8],[34,268,63,25,"x0"],[34,270,63,8],[34,272,63,29,"sin1"],[34,276,63,8],[34,277,61,6],[34,278,59,4],[34,279,57,30],[34,280,57,2],[35,0,69,2],[35,8,69,8,"criticallyDampedEnvelope"],[35,32,69,32],[35,35,69,35],[35,50,69,39],[35,70,69,48],[35,71,69,49],[35,72,69,39],[35,74,69,52,"omega0"],[35,80,69,39],[35,82,69,60,"t"],[35,83,69,39],[35,84,69,35],[35,85,69,2],[36,0,70,2],[36,8,70,8,"criticallyDampedPosition"],[36,32,70,32],[36,35,70,35],[36,50,71,4,"config"],[36,56,71,10],[36,57,71,11,"toValue"],[36,64,70,35],[36,66,72,4],[36,86,73,6,"criticallyDampedEnvelope"],[36,110,72,4],[36,112,74,6],[36,127,74,10,"x0"],[36,129,74,6],[36,131,74,14],[36,151,74,23],[36,166,74,27,"v0"],[36,168,74,23],[36,170,74,31],[36,190,74,40,"omega0"],[36,196,74,31],[36,198,74,48,"x0"],[36,200,74,31],[36,201,74,23],[36,202,74,14],[36,204,74,54,"t"],[36,205,74,14],[36,206,74,6],[36,207,72,4],[36,208,70,35],[36,209,70,2],[37,0,77,2],[37,8,77,8,"criticallyDampedVelocity"],[37,32,77,32],[37,35,77,35],[37,55,78,4,"criticallyDampedEnvelope"],[37,79,77,35],[37,81,79,4],[37,96,80,6],[37,116,80,15,"v0"],[37,118,80,6],[37,120,80,19],[37,135,80,23],[37,155,80,32,"t"],[37,156,80,23],[37,158,80,35,"omega0"],[37,164,80,23],[37,165,80,19],[37,167,80,44],[37,168,80,19],[37,169,80,6],[37,170,79,4],[37,172,81,6],[37,192,81,15,"t"],[37,193,81,6],[37,195,81,18,"x0"],[37,197,81,6],[37,199,81,22,"omega0"],[37,205,81,6],[37,207,81,30,"omega0"],[37,213,81,6],[37,214,79,4],[37,215,77,35],[37,216,77,2],[38,0,86,2],[38,8,86,8,"prevPosition"],[38,20,86,20],[38,23,86,23],[38,27,86,27,"AnimatedValue"],[38,49,86,23],[38,50,86,41],[38,51,86,23],[38,52,86,2],[39,0,88,2],[39,8,88,8,"isOvershooting"],[39,22,88,22],[39,25,88,25],[39,41,89,4],[39,56,89,8,"config"],[39,62,89,14],[39,63,89,15,"overshootClamping"],[39,80,89,4],[39,82,89,34],[39,97,89,38,"config"],[39,103,89,44],[39,104,89,45,"stiffness"],[39,113,89,34],[39,115,89,56],[39,116,89,34],[39,117,89,4],[39,118,88,25],[39,120,90,4],[39,136,91,6],[39,156,91,15,"prevPosition"],[39,168,91,6],[39,170,91,29,"config"],[39,176,91,35],[39,177,91,36,"toValue"],[39,184,91,6],[39,185,90,4],[39,187,92,6],[39,210,92,18,"state"],[39,215,92,23],[39,216,92,24,"position"],[39,224,92,6],[39,226,92,34,"config"],[39,232,92,40],[39,233,92,41,"toValue"],[39,240,92,6],[39,241,90,4],[39,243,93,6],[39,263,93,15,"state"],[39,268,93,20],[39,269,93,21,"position"],[39,277,93,6],[39,279,93,31,"config"],[39,285,93,37],[39,286,93,38,"toValue"],[39,293,93,6],[39,294,90,4],[39,295,88,25],[39,296,88,2],[40,0,96,2],[40,8,96,8,"isVelocity"],[40,18,96,18],[40,21,96,21],[40,41,96,30],[40,59,96,34,"state"],[40,64,96,39],[40,65,96,40,"velocity"],[40,73,96,30],[40,74,96,21],[40,76,96,51,"config"],[40,82,96,57],[40,83,96,58,"restSpeedThreshold"],[40,101,96,21],[40,102,96,2],[41,0,97,2],[41,8,97,8,"isDisplacement"],[41,22,97,22],[41,25,97,25],[41,39,98,4],[41,53,98,7,"config"],[41,59,98,13],[41,60,98,14,"stiffness"],[41,69,98,4],[41,71,98,25],[41,72,98,4],[41,73,97,25],[41,75,99,4],[41,95,100,6],[41,113,100,10],[41,128,100,14,"config"],[41,134,100,20],[41,135,100,21,"toValue"],[41,142,100,10],[41,144,100,30,"state"],[41,149,100,35],[41,150,100,36,"position"],[41,158,100,10],[41,159,100,6],[41,160,99,4],[41,162,101,6,"config"],[41,168,101,12],[41,169,101,13,"restDisplacementThreshold"],[41,194,99,4],[41,195,97,25],[41,196,97,2],[42,0,105,2],[42,11,105,9],[42,28,105,15],[42,29,106,4],[42,44,106,8,"prevPosition"],[42,56,106,4],[42,58,106,22,"state"],[42,63,106,27],[42,64,106,28,"position"],[42,72,106,4],[42,73,105,15],[42,75,107,4],[42,91,108,6],[42,111,108,15,"zeta"],[42,115,108,6],[42,117,108,21],[42,118,108,6],[42,119,107,4],[42,121,109,6],[42,122,110,8],[42,137,110,12,"state"],[42,142,110,17],[42,143,110,18,"position"],[42,151,110,8],[42,153,110,28,"underDampedPosition"],[42,172,110,8],[42,173,109,6],[42,175,111,8],[42,190,111,12,"state"],[42,195,111,17],[42,196,111,18,"velocity"],[42,204,111,8],[42,206,111,28,"underDampedVelocity"],[42,225,111,8],[42,226,109,6],[42,227,107,4],[42,229,113,6],[42,230,114,8],[42,245,114,12,"state"],[42,250,114,17],[42,251,114,18,"position"],[42,259,114,8],[42,261,114,28,"criticallyDampedPosition"],[42,285,114,8],[42,286,113,6],[42,288,115,8],[42,303,115,12,"state"],[42,308,115,17],[42,309,115,18,"velocity"],[42,317,115,8],[42,319,115,28,"criticallyDampedVelocity"],[42,343,115,8],[42,344,113,6],[42,345,107,4],[42,346,105,15],[42,348,118,4],[42,363,118,8,"state"],[42,368,118,13],[42,369,118,14,"time"],[42,373,118,4],[42,375,118,20,"clock"],[42,380,118,4],[42,381,105,15],[42,383,119,4],[42,399,119,9],[42,413,119,12,"isOvershooting"],[42,427,119,9],[42,429,119,28],[42,444,119,32,"isVelocity"],[42,454,119,28],[42,456,119,44,"isDisplacement"],[42,470,119,28],[42,471,119,9],[42,472,119,4],[42,474,119,62],[42,475,120,6],[42,491,120,11],[42,506,120,15,"config"],[42,512,120,21],[42,513,120,22,"stiffness"],[42,522,120,11],[42,524,120,33],[42,525,120,11],[42,526,120,6],[42,528,120,37],[42,529,121,8],[42,544,121,12,"state"],[42,549,121,17],[42,550,121,18,"velocity"],[42,558,121,8],[42,560,121,28],[42,561,121,8],[42,562,120,37],[42,564,122,8],[42,579,122,12,"state"],[42,584,122,17],[42,585,122,18,"position"],[42,593,122,8],[42,595,122,28,"config"],[42,601,122,34],[42,602,122,35,"toValue"],[42,609,122,8],[42,610,120,37],[42,611,120,6],[42,612,119,62],[42,614,124,6],[42,629,124,10,"state"],[42,634,124,15],[42,635,124,16,"finished"],[42,643,124,6],[42,645,124,26],[42,646,124,6],[42,647,119,62],[42,648,119,4],[42,649,105,15],[42,650,105,9],[42,651,105,2],[43,0,127,1]]},"type":"js/module"}]}